<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¬Ù†Ú¯ Ù‡ÙˆØ§Ù¾ÛŒÙ…Ø§Ù‡Ø§</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #111;
        touch-action: none; /* Ù…Ù‡Ù… Ø¨Ø±Ø§ÛŒ Ú©Ù†ØªØ±Ù„ Ù„Ù…Ø³ÛŒ */
        font-family: sans-serif;
    }
    canvas {
        display: block;
        margin: auto;
        border: 2px solid #fff;
        background: #222;
    }
    /* Ø¯Ú©Ù…Ù‡ Ø´Ù„ÛŒÚ© */
    #shootBtn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: #f00;
        color: white;
        font-size: 20px;
        text-align: center;
        line-height: 80px;
        user-select: none;
        z-index: 10;
    }
</style>
</head>
<body>

<canvas id="game" width="700" height="400"></canvas>
<div id="shootBtn">ðŸ”«</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const shootBtn = document.getElementById("shootBtn");

// ØªØµØ§ÙˆÛŒØ±
let playerImg = new Image();
playerImg.src = 'assets/player.png';

let enemyImg = new Image();
enemyImg.src = 'assets/enemy1.png';

let bulletImg = new Image();
bulletImg.src = 'assets/bullet.png';

// Ø¨Ø§Ø²ÛŒÚ©Ù†
let player = {
    x: 50,
    y: 180,
    w: 60,
    h: 60
};

// Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
let bullets = [];

// Ø¯Ø´Ù…Ù†â€ŒÙ‡Ø§
let enemies = [];
let frame = 0;
let score = 0;

// Ø³Ø§Ø®Øª Ø¯Ø´Ù…Ù†
function spawnEnemy() {
    let size = 50;
    enemies.push({
        x: canvas.width,
        y: Math.random() * (canvas.height - size),
        w: size,
        h: size,
        speed: 3 + Math.random() * 2
    });
}

// Ø´Ù„ÛŒÚ© Ú¯Ù„ÙˆÙ„Ù‡
function shoot() {
    bullets.push({
        x: player.x + player.w,
        y: player.y + player.h / 2 - 10,
        w: 20,
        h: 20,
        speed: 8
    });
}

// Ú©Ù†ØªØ±Ù„ Ù„Ù…Ø³ÛŒ Ø¨Ø§Ø²ÛŒÚ©Ù†
canvas.addEventListener("touchmove", function(e){
    let t = e.touches[0];
    let rect = canvas.getBoundingClientRect();
    player.y = t.clientY - rect.top - player.h/2;
    if(player.y < 0) player.y = 0;
    if(player.y + player.h > canvas.height) player.y = canvas.height - player.h;
    e.preventDefault();
});

// Ø¯Ú©Ù…Ù‡ Ø´Ù„ÛŒÚ© Ù„Ù…Ø³ÛŒ
shootBtn.addEventListener("touchstart", shoot);

// Ø¢Ù¾Ø¯ÛŒØª Ø¨Ø§Ø²ÛŒ
function update() {
    frame++;
    if(frame % 80 === 0) spawnEnemy();

    // Ø­Ø±Ú©Øª Ú¯Ù„ÙˆÙ„Ù‡
    bullets.forEach((b,i)=>{
        b.x += b.speed;
        if(b.x > canvas.width) bullets.splice(i,1);
    });

    // Ø­Ø±Ú©Øª Ø¯Ø´Ù…Ù†
    enemies.forEach((en,i)=>{
        en.x -= en.speed;

        // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡ Ø¨Ø§ Ø¯Ø´Ù…Ù†
        bullets.forEach((b,j)=>{
            if(
                b.x < en.x + en.w &&
                b.x + b.w > en.x &&
                b.y < en.y + en.h &&
                b.y + b.h > en.y
            ){
                enemies.splice(i,1);
                bullets.splice(j,1);
                score++;
            }
        });

        // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ø¯Ø´Ù…Ù† Ø¨Ø§ Ø¨Ø§Ø²ÛŒÚ©Ù† = Ø¨Ø§Ø®Øª
        if(
            player.x < en.x + en.w &&
            player.x + player.w > en.x &&
            player.y < en.y + en.h &&
            player.y + player.h > en.y
        ){
            alert("Ø¨Ø§Ø®ØªÛŒ! Ø§Ù…ØªÛŒØ§Ø²: " + score);
            document.location.reload();
        }
    });

    draw();
    requestAnimationFrame(update);
}

// Ø±Ø³Ù…
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Ø¨Ø§Ø²ÛŒÚ©Ù†
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);

    // Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
    bullets.forEach(b=>{
        ctx.drawImage(bulletImg, b.x, b.y, b.w, b.h);
    });

    // Ø¯Ø´Ù…Ù†â€ŒÙ‡Ø§
    enemies.forEach(en=>{
        ctx.drawImage(enemyImg, en.x, en.y, en.w, en.h);
    });

    // Ø§Ù…ØªÛŒØ§Ø²
    ctx.fillStyle = "#fff";
    ctx.font = "20px Arial";
    ctx.fillText("Score: " + score, 10, 25);
}

update();
</script>

</body>
</html>
